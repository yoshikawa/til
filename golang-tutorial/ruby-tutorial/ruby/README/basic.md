## Ruby の基礎を理解

### Ruby はオブジェクト指向言語

文字列や配列はもちろん、数値や nil を含めて、すべてがオブジェクト。

その証拠に数値や nil、true や false に対してもメソッドを呼び出すことが出来ます。

以下、確認したコード

```rb
irb(main):001:0> '1'.to_s
=> "1"
irb(main):002:0> 1.to_s
=> "1"
irb(main):003:0> nil.to_s
=> ""
irb(main):004:0> true.to_s
=> "true"
irb(main):005:0> false.to_s
=> "false"
irb(main):006:0> /\d+/.to_s
=> "(?-mix:\\d+)"
```

### メソッド呼び出し

Ruby では次のような形式でオブジェクトのメソッドを呼び出すことができます。

`オブジェクト.メソッド(引数 1, 引数 2, 引数 3)`

引数の括弧は省略することも出来ます。

`オブジェクト.メソッド 引数 1, 引数 2, 引数 3`

引数がなければ、次のようにメソッドの名前だけを書くことも出来ます。

`オブジェクト.メソッド`

### リテラル

ソースコードに直接埋め込む事ができる値のことをリテラルといいます。

```rb
# 数値
123

# 文字列
"Hello"

# 配列
[1, 2, 3]

# ハッシュ
{'japan' => 'yen', 'us' => 'dollar', 'india' => 'rupee'}

# 正規表現
/\d+-\d+/
```

### 変数(ローカル変数)の宣言と代入

変数は次のようにして宣言と代入を同時に行います。

`変数名 = 式や値`

```rb
# 変数を宣言する目的で変数名だけ書くと、エラーになる
x #=> NameError

x = nil

# 変数名はスネークケースで書く
special_price = 200
```

### 文字列

シングルクオートとダブルクオート

```rb
'これは文字列です。'
"これは文字列です。"
```

上のコード例ではどちらも文字列としての違いはありませんが、シングルクオートとダブルクオートでは挙動が異なる点があります。

文字列中に改行文字(\n)を埋め込みたい場合は、ダブルクオートで囲む必要があります。

```rb
# ダブルクオートで囲むと\nが改行文字として機能する
puts "こんにちは\nさようなら"
#=> こんにちは
#   さようなら

# シングルクオートで囲むと\nはただの文字列になる
puts 'こんにちは\nさようなら'
#=> こんにちは\nさようなら
```

ダブルクオートを使うと式展開が使えます。式展開を使う場合は#{ }の中に変数や式を書きます。

```rb
name = 'Alice'
puts "Hello, #{name}!" #=> Hello, Alice!

i = 10
puts "#{i}は16進数にすると#{i.to_s(16)}です" #=> 10は16進数にするとaです
```

### 文字列の比較

```rb
'ruby' == 'ruby' #=> true
'ruby' == 'Ruby' #=> false
'ruby' != 'false' #=> true
'ruby' != 'ruby' #=> false
```

<, <=, >, >=を使って大小関係を比較することが出来る。

```rb
'a' < 'b' #=> true
'a' < 'A' #=> false
'a' > 'A' #=> true
'abc' > 'def' #=> true
'abc' < 'ab' #=> false
'abc' < 'abcd' #=> true
'あいうえお' < 'かきくけこ' #=> true
```

### 数値

```rb
# 正の整数
10
# 小数
1.5
# 負の整数
-3
# 負の小数
-4.75
```

数値には`_`を含めることが出来ます。`_`は無視されるので、大きな数の区切り文字として使うと便利。

```rb
1_000_000_000 #=> 1000000000
```

```rb
10 + 20 #=> 30
100 - 25 #=> 75
12 * 5 #=> 60
20 / 5 #=> 4
```

変数の手間に`-`を付けると、数値の正と負を反転できます。

```rb
n = 1
-n #=> -1
```

整数同士の割り算は整数になる点に注意してください。小数点以下は切り捨てられます。

```rb
1 / 2 #=> 0
```

小数点以下の値が必要な場合は。どちらかの値に小数点の.0 を付けます。

```rb
1.0 / 2 #=> 0.5
1 / 2.0 #=> 0.5
```

変数に整数が入っている場合は、`to_fメソッド`を呼ぶことで整数から小数に変更することができます。

```rb
n = 1
n.to_f     #=> 1.0
n.to_f / 2 #=> 0.5
```

`%`は割り算の余りを求める演算子です。

```rb
8 % 3 #=> 2
```

`**`はべき乗を求める演算子です。

```rb
2 ** 3 #=> 8
```

#### 変数に格納された数値の増減

```rb
n = 1

# ++は構文として無効
# n++

# nを1増やす
n += 1

# nを1減らす
n -= 1
```

同様に`*=, /=, **=`も使える。

### 真偽値

```rb
# trueそのもの
true

# すべての数値
1
0
-1

# すべての文字列
'true'
'false'
''
```

nil も偽になる。実際のプログラミングではオブジェクトが nil かどうかで条件分岐させる機会が多いので、意外と便利。

データがあればそのデータを、データがなければ nil を返す find_data という架空のメソッドがあったとします。
データのある/なしで処理を変えたい場合、素直に nil かどうかをチェックすると次のようなコードになる。

```rb
data = find_data
if data != nil
  'データがあります'
else
  'データはありません'
end
```

Ruby の場合、false と nil 以外はすべて真なので、次のようなシンプルに書けます。

```rb
data = find_data
if data != nil
  'データがあります'
else
  'データはありません'
end
```

### 論理演算子

`&&`や`||`のような論理演算子を使うと、複数の条件を 1 つにまとめることができます。

`条件1 && 条件2`、条件 1 かつ条件 2

`条件1 || 条件2`、条件 1 または条件 2

### if 文

条件分岐でよく使われる if 文を Ruby で書く。

```rb
if 条件A
  # 条件Aが真だった場合の処理
elsif 条件B
  # 条件Bが真だった場合の処理
elsif 条件C
  # 条件Cが真だった場合の処理
else
  # それ以外の条件の処理
end
```

条件を複数指定する場合は else if や elseif ではなく、elsif であるので注意。

「if 文が戻り値を返す」という性質を利用して、次のように if 文の戻り値を変数に代入することも出来ます。

```rb
country = 'italy'

# if文の戻り値を変数に代入する
greeeting =
  if country == 'japan'
    'こんにちは'
  elsif country == 'us'
    'Hello'
  elsif country == 'italy'
    'ciao'
  else
    '???'
  end

greeting #=> "ciao"
```

### メソッドの定義

Ruby は def を使ってメソッドを定義します。

```rb
def add(a, b)
  a + b
end
add(1, 2) #=> 3
```
